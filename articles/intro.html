<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to aquamapsdata • aquamapsdata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to aquamapsdata">
<meta property="og:description" content="aquamapsdata">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aquamapsdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Introduction to aquamapsdata</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/raquamaps/aquamapsdata/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intro_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="intro_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="intro_files/jquery-1.12.4/jquery.min.js"></script><link href="intro_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="intro_files/datatables-binding-0.15/datatables.js"></script><link href="intro_files/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="intro_files/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="intro_files/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="intro_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="intro_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to aquamapsdata</h1>
                        <h4 class="author">Markus Skyttner</h4>
            
            <h4 class="date">2020-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/raquamaps/aquamapsdata/blob/master/vignettes/intro.Rmd"><code>vignettes/intro.Rmd</code></a></small>
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<p>This document describes how to use the <code>aquamapsdata</code> R data package to access curated data through a static database assembled from data sourced from <a href="http://aquamaps.org" class="uri">http://aquamaps.org</a></p>
<p>Immediately after installing the package, a run-once action is needed, in order to download and locally create the SQLite database containing all the AquaMaps data.</p>
<p>Approximately 5G disk space is needed locally for the database file. The download is around 1G compressed and therefore a speedy Internet connection is recommended for this initial step.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co"># install aquamapsdata from GitHub using devtools</span>

<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">install_gitub</span><span class="op">(</span><span class="st">"raquamaps/aquamapsdata"</span><span class="op">)</span>

<span class="co"># initial run-once step required to install remote db locally</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/raquamaps/aquamapsdata">aquamapsdata</a></span><span class="op">)</span>
<span class="fu"><a href="../reference/download_db.html">download_db</a></span><span class="op">(</span>force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>Once the database is available locally, it can be queries using a couple of different functions.</p>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>The following code shows a few ways to query the database through some functions provided in the package</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/raquamaps/aquamapsdata">aquamapsdata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="va">my_db</span> <span class="op">&lt;-</span> <span class="fu">aquamapsdata</span><span class="fu">:::</span><span class="fu">src_sqlite_aquamapsdata</span><span class="op">(</span><span class="op">)</span>

<span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"nativemaps"</span><span class="op">)</span>
<span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"hcaf"</span><span class="op">)</span>
<span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"hspen"</span><span class="op">)</span>
<span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"occ"</span><span class="op">)</span>
<span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"taxa"</span><span class="op">)</span></pre></div>
<div id="queries" class="section level2">
<h2 class="hasAnchor">
<a href="#queries" class="anchor"></a>Queries</h2>
<p>The <code>dplyr</code> package can be used to query the various tables available in the database.</p>
<p>Here is an example of a query for the total record count in one of the tables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/raquamaps/aquamapsdata">aquamapsdata</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>

<span class="va">my_db</span> <span class="op">&lt;-</span> <span class="fu">aquamapsdata</span><span class="fu">:::</span><span class="fu">src_sqlite_aquamapsdata</span><span class="op">(</span><span class="op">)</span>

<span class="va">record_count</span> <span class="op">&lt;-</span> 
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"occ"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">collect</span> <span class="op">%&gt;%</span> 
  <span class="va">.</span><span class="op">$</span><span class="va">count</span>

<span class="va">record_count</span></pre></div>
<pre><code>## [1] 100</code></pre>
<p>Here is an example of a query for a specific identifier in another table:</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="co"># filter one table for a specific record</span>
<span class="va">taxon_wide</span> <span class="op">&lt;-</span> 
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"taxa"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">SPECIESID</span> <span class="op">==</span> <span class="st">"Fis-26653"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="va">collect</span>

<span class="co"># pivot the result for easier display  </span>
<span class="va">taxon_tall</span> <span class="op">&lt;-</span> 
  <span class="va">taxon_wide</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="va">col_name</span>, <span class="va">col_val</span><span class="op">)</span>

<span class="co"># display</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">taxon_tall</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">col_name</th>
<th align="left">col_val</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SPECIESID</td>
<td align="left">Fis-26653</td>
</tr>
<tr class="even">
<td align="left">SPECIESID_2016_Default</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">SPECIESID_2015</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">SPECIESID_2013</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">SPECIESID_2010</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">IDChange</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Reviewed</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">expert_id</td>
<td align="left">7</td>
</tr>
<tr class="odd">
<td align="left">SpecCode</td>
<td align="left">7708</td>
</tr>
<tr class="even">
<td align="left">Genus</td>
<td align="left">Pomadasys</td>
</tr>
<tr class="odd">
<td align="left">Species</td>
<td align="left">stridens</td>
</tr>
<tr class="even">
<td align="left">FBname</td>
<td align="left">Striped piggy</td>
</tr>
<tr class="odd">
<td align="left">FBName_DE</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">OccurRecs</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">OccurCells</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">OccurCells_Exp</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">OccurCells_2015</td>
<td align="left">35</td>
</tr>
<tr class="even">
<td align="left">OccurCells_2013</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">Kingdom</td>
<td align="left">Animalia</td>
</tr>
<tr class="even">
<td align="left">Phylum</td>
<td align="left">Chordata</td>
</tr>
<tr class="odd">
<td align="left">Class</td>
<td align="left">Actinopterygii</td>
</tr>
<tr class="even">
<td align="left">Order</td>
<td align="left">Perciformes</td>
</tr>
<tr class="odd">
<td align="left">Family</td>
<td align="left">Haemulidae</td>
</tr>
<tr class="even">
<td align="left">map_beforeafter</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">map_seasonal</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">with_gte_5</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">with_gte_6</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">with_gt_66</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">no_of_cells_3</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">no_of_cells_5</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">no_of_cells_0</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">database_id</td>
<td align="left">10</td>
</tr>
<tr class="odd">
<td align="left">picname</td>
<td align="left">Postr_u3.jpg</td>
</tr>
<tr class="even">
<td align="left">entered</td>
<td align="left">50</td>
</tr>
<tr class="odd">
<td align="left">total_native_csc_cnt</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">deepwater</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">m_mammals</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">angling</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">diving</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">dangerous</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">m_invertebrates</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">algae</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">seabirds</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">freshwater</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">highseas</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">countriesintroduced</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">invasive</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">iucn_id</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">iucn_code</td>
<td align="left">N.E.</td>
</tr>
<tr class="even">
<td align="left">iucn_version</td>
<td align="left">2015-2</td>
</tr>
<tr class="odd">
<td align="left">resilience</td>
<td align="left">High</td>
</tr>
<tr class="even">
<td align="left">no_default</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
<p>Here is an example of a summary query across several tables:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org">purrr</a></span><span class="op">)</span>

<span class="co"># function which gives the record cound for a given table</span>
<span class="va">ls_count</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">table</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">collect</span> <span class="op">%&gt;%</span> <span class="va">.</span><span class="op">$</span><span class="va">count</span>
  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ops</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>table <span class="op">=</span> <span class="va">title</span>, record_count <span class="op">=</span> <span class="va">res</span><span class="op">)</span>
  
<span class="op">}</span>

<span class="co"># get record counts for all tables</span>
<span class="va">am_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"nativemaps"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_count</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"hcaf"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_count</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"hspen"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_count</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"occ"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_count</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"taxa"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_count</span>
<span class="op">)</span>

<span class="co"># display</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">am_counts</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">table</th>
<th align="right">record_count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">nativemaps</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left">occ</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">taxa</td>
<td align="right">25078</td>
</tr>
</tbody>
</table>
<p>Here is an example of fuzzy and exact name searchers, returning keys with the internal identifiers used in the database. Those keys can be used to retrieve other information, such as environmental envelopes etc.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="co"># fuzzy search for "trout OR cod"</span>

<span class="va">keys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/am_name_search_fuzzy.html">am_name_search_fuzzy</a></span><span class="op">(</span><span class="st">"trout OR cod"</span><span class="op">)</span><span class="op">$</span><span class="va">key</span>

<span class="co"># exact results for all those keys</span>

<span class="va">hits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span><span class="op">(</span><span class="va">keys</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/am_name_search_exact.html">am_name_search_exact</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="co"># we inspect the species list we got </span>

<span class="va">display</span> <span class="op">&lt;-</span> <span class="va">hits</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">key</span>, <span class="va">binomial</span>, <span class="va">rank_family</span>, <span class="va">vernacular</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">display</span><span class="op">)</span></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="38%">
<col width="20%">
<col width="27%">
</colgroup>
<thead><tr class="header">
<th align="left">key</th>
<th align="left">binomial</th>
<th align="left">rank_family</th>
<th align="left">vernacular</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Fis-29394</td>
<td align="left">Gadus morhua</td>
<td align="left">Gadidae</td>
<td align="left">Atlantic cod</td>
</tr>
<tr class="even">
<td align="left">Fis-21630</td>
<td align="left">Salmo trutta</td>
<td align="left">Salmonidae</td>
<td align="left">Sea trout</td>
</tr>
<tr class="odd">
<td align="left">Fis-22919</td>
<td align="left">Oncorhynchus mykiss</td>
<td align="left">Salmonidae</td>
<td align="left">Rainbow trout</td>
</tr>
<tr class="even">
<td align="left">Fis-22950</td>
<td align="left">Salvelinus fontinalis</td>
<td align="left">Salmonidae</td>
<td align="left">Brook trout</td>
</tr>
<tr class="odd">
<td align="left">Fis-29393</td>
<td align="left">Gadus macrocephalus</td>
<td align="left">Gadidae</td>
<td align="left">Pacific cod</td>
</tr>
<tr class="even">
<td align="left">Fis-29395</td>
<td align="left">Gadus ogac</td>
<td align="left">Gadidae</td>
<td align="left">Greenland cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-22874</td>
<td align="left">Eleginus gracilis</td>
<td align="left">Gadidae</td>
<td align="left">Saffron cod</td>
</tr>
<tr class="even">
<td align="left">Fis-22850</td>
<td align="left">Boreogadus saida</td>
<td align="left">Gadidae</td>
<td align="left">Polar cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-23211</td>
<td align="left">Parapercis colias</td>
<td align="left">Pinguipedidae</td>
<td align="left">New Zealand blue cod</td>
</tr>
<tr class="even">
<td align="left">Fis-23313</td>
<td align="left">Trisopterus minutus</td>
<td align="left">Gadidae</td>
<td align="left">Poor cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-23375</td>
<td align="left">Arctogadus glacialis</td>
<td align="left">Gadidae</td>
<td align="left">Arctic cod</td>
</tr>
<tr class="even">
<td align="left">Fis-30744</td>
<td align="left">Tripterophycis gilchristi</td>
<td align="left">Moridae</td>
<td align="left">Grenadier cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-156254</td>
<td align="left">Oncorhynchus clarkii</td>
<td align="left">Salmonidae</td>
<td align="left">Cutthroat trout</td>
</tr>
<tr class="even">
<td align="left">Fis-25479</td>
<td align="left">Patagonotothen tessellata</td>
<td align="left">Nototheniidae</td>
<td align="left">Black southern cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-32206</td>
<td align="left">Muraenolepis microps</td>
<td align="left">Muraenolepididae</td>
<td align="left">Smalleye moray cod</td>
</tr>
<tr class="even">
<td align="left">Fis-32207</td>
<td align="left">Muraenolepis orangiensis</td>
<td align="left">Muraenolepididae</td>
<td align="left">Patagonian moray cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-132766</td>
<td align="left">Guttigadus kongi</td>
<td align="left">Moridae</td>
<td align="left">Austral cod</td>
</tr>
<tr class="even">
<td align="left">Fis-32209</td>
<td align="left">Melanonus gracilis</td>
<td align="left">Melanonidae</td>
<td align="left">Pelagic cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-32663</td>
<td align="left">Euclichthys polynemus</td>
<td align="left">Euclichthyidae</td>
<td align="left">Eucla cod</td>
</tr>
<tr class="even">
<td align="left">Fis-26963</td>
<td align="left">Plectorhinchus pictus</td>
<td align="left">Haemulidae</td>
<td align="left">Trout sweetlips</td>
</tr>
<tr class="odd">
<td align="left">Fis-32814</td>
<td align="left">Bregmaceros mcclellandi</td>
<td align="left">Bregmacerotidae</td>
<td align="left">Unicorn cod</td>
</tr>
<tr class="even">
<td align="left">Fis-27758</td>
<td align="left">Patagonotothen ramsayi</td>
<td align="left">Nototheniidae</td>
<td align="left">Longtail southern cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-34101</td>
<td align="left">Physiculus nigrescens</td>
<td align="left">Moridae</td>
<td align="left">Darktip cod</td>
</tr>
<tr class="even">
<td align="left">Fis-34769</td>
<td align="left">Physiculus roseus</td>
<td align="left">Moridae</td>
<td align="left">Rosy cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-35280</td>
<td align="left">Galaxias truttaceus</td>
<td align="left">Galaxiidae</td>
<td align="left">Spotted mountain trout</td>
</tr>
<tr class="even">
<td align="left">Fis-132770</td>
<td align="left">Guttigadus globiceps</td>
<td align="left">Moridae</td>
<td align="left">Fat-headed cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-35713</td>
<td align="left">Lepidion microcephalus</td>
<td align="left">Moridae</td>
<td align="left">Small-headed cod</td>
</tr>
<tr class="even">
<td align="left">Fis-35714</td>
<td align="left">Physiculus luminosa</td>
<td align="left">Moridae</td>
<td align="left">Luminescent cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-138560</td>
<td align="left">Scorpaena papillosa</td>
<td align="left">Scorpaenidae</td>
<td align="left">Red rock cod</td>
</tr>
<tr class="even">
<td align="left">Fis-53166</td>
<td align="left">Lepidion inosimae</td>
<td align="left">Moridae</td>
<td align="left">Morid cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-53173</td>
<td align="left">Lepidion schmidti</td>
<td align="left">Moridae</td>
<td align="left">Schmidt’s cod</td>
</tr>
<tr class="even">
<td align="left">Fis-149273</td>
<td align="left">Gadella jordani</td>
<td align="left">Moridae</td>
<td align="left">Jordan’s cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-138548</td>
<td align="left">Lotella rhacina</td>
<td align="left">Moridae</td>
<td align="left">Rock cod</td>
</tr>
<tr class="even">
<td align="left">Fis-56732</td>
<td align="left">Bregmaceros rarisquamosus</td>
<td align="left">Bregmacerotidae</td>
<td align="left">Big-eye unicorn-cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-114147</td>
<td align="left">Physiculus therosideros</td>
<td align="left">Moridae</td>
<td align="left">Scalyfin cod</td>
</tr>
<tr class="even">
<td align="left">Fis-132563</td>
<td align="left">Physiculus longifilis</td>
<td align="left">Moridae</td>
<td align="left">Filament cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-158488</td>
<td align="left">Muraenolepis marmorata</td>
<td align="left">Muraenolepididae</td>
<td align="left">Marbled moray cod</td>
</tr>
<tr class="even">
<td align="left">Fis-164244</td>
<td align="left">Notomuraenobathys microcephalus</td>
<td align="left">Muraenolepididae</td>
<td align="left">Smallhead moray cod</td>
</tr>
<tr class="odd">
<td align="left">Fis-132771</td>
<td align="left">Guttigadus globosus</td>
<td align="left">Moridae</td>
<td align="left">Tadpole cod</td>
</tr>
<tr class="even">
<td align="left">Fis-132564</td>
<td align="left">Tripterophycis svetovidovi</td>
<td align="left">Moridae</td>
<td align="left">Brown grenadier cod</td>
</tr>
</tbody>
</table>
<blockquote>
<p>What would be the most frequently needed queries? These could be wrapped up and exposed as documented functions.</p>
</blockquote>
</div>
<div id="schema" class="section level2">
<h2 class="hasAnchor">
<a href="#schema" class="anchor"></a>Schema</h2>
<p>For a table such as the <code>occ</code> table, columns are currently named using different styles, as seen in the earlier example. For example a mix of UPPERCASE, snake case delimited lower case words, CamelCasedWord, nocase etc:</p>
<pre><code>SPECIESID
SPECIESID_2016_Default
IDChange
Reviewed
expert_id
map_beforeafter
map_seasonal
picname</code></pre>
<blockquote>
<p>Should column names be harmonized? A “mapping table” could do this.</p>
</blockquote>
<blockquote>
<p>If so, what would be a good set of harmonized column names?</p>
</blockquote>
<p>Listing all the columns in all tables of the database and their types gives us a feel for the schema:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span>

<span class="co"># for a db table, return a tibble with the columns and their data types</span>
<span class="va">ls_types</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">table</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">table</span> <span class="op">%&gt;%</span> <span class="va">head</span> <span class="op">%&gt;%</span> <span class="va">collect</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">type_sum</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">unlist</span>
  <span class="va">colname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">table</span><span class="op">$</span><span class="va">ops</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>table <span class="op">=</span> <span class="va">title</span>, col_name <span class="op">=</span> <span class="va">colname</span>, col_type <span class="op">=</span> <span class="va">res</span>, desc <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># run the above function on all tables</span>
<span class="va">am_schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"nativemaps"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_types</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"hcaf"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_types</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"hspen"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_types</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"occ"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_types</span>,
  <span class="va">my_db</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="st">"taxa"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ls_types</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">am_schema</span><span class="op">)</span></pre></div>
<div id="htmlwidget-6c9c84aefa3480f7e3be" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c9c84aefa3480f7e3be">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249"],["nativemaps","nativemaps","nativemaps","nativemaps","nativemaps","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hcaf","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","hspen","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","occ","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa","taxa"],["SpeciesID","CsquareCode","probability","FAOAreaYN","BoundBoxYN","CsquareCode","LOICZID","NLimit","Slimit","WLimit","ELimit","CenterLat","CenterLong","CellArea","OceanArea","CellType","PWater","FAOAreaM","FAOAreaIn","CountryMain","CountrySecond","CountryThird","CountrySubMain","CountrySubSecond","CountrySubThird","EEZ","EEZRemark","LME","LMEBorder","MEOW","OceanBasin","Longhurst","IslandsNo","Area0_20","Area20_40","Area40_60","Area60_80","Area80_100","AreaBelow100","ElevationMin","ElevationMax","ElevationMean","ElevationSD","DepthMin","DepthMax","DepthMean","DepthSD","SSTMnMin","SSTMnMax","SSTAnMean","SSTAnSD","SSTMnRange","SBTAnMean","SalinityMin","SalinityMax","SalinityMean","SalinitySD","SalinityBMean","PrimProdMean","IceConAnn","Shelf","Slope","IceConSpr","IceConSum","IceConFal","IceConWin","LandDist","WaveHeight","TidalRange","Abyssal","Coral","Estuary","Seamount","MPA","SST1950","SBT1950","Salinity1950","SalinityB1950","PrimProd1950","IceCon1950","SST1999","SBT1999","Salinity1999","SalinityB1999","PrimProd1999","IceCon1999","SST2050","SBT2050","Salinity2050","SalinityB2050","PrimProd2050","IceCon2050","SST2100","SBT2100","Salinity2100","SalinityB2100","PrimProd2100","IceCon2100","SST1950c","SBT1950c","Salinity1950c","SalinityB1950c","PrimProd1950c","IceCon1950c","SST2050c","SBT2050c","Salinity2050c","SalinityB2050c","PrimProd2050c","IceCon2050c","SST2100c","SBT2100c","Salinity2100c","SalinityB2100c","IceCon2100c","PrimProd2100c","Speccode","SpeciesID","LifeStage","FAOAreas","FAOAreasRef","FAOComplete","NMostLat","SMostLat","WMostLong","EMostLong","LME","DepthYN","DepthMin","DepthPrefMin","DepthPrefMax","DepthMax","MeanDepth","DepthRef","Pelagic","TempYN","TempMin","TempPrefMin","TempPrefMax","TempMax","TempRef","SalinityYN","SalinityMin","SalinityPrefMin","SalinityPrefMax","SalinityMax","SalinityRef","PrimProdYN","PrimProdMin","PrimProdPrefMin","PrimProdPrefMax","PrimProdMax","PrimProdPrefRef","IceConYN","IceConMin","IceConPrefMin","IceConPrefMax","IceConMax","IceConRef","LandDistYN","LandDistMin","LandDistPrefMin","LandDistPrefMax","LandDistMax","LandDistRef","Remark","DateCreated","DateModified","Expert","DateExpert","Envelope","MapData","Effort","Layer","UsePoints","Rank","MapOpt","ExtnRuleYN","IPCC","Reviewed","OccurCells","ExpertEdited","inc","CsquareCode","SpeciesID","SpecCode","GoodCell","InFAOArea","InBoundBox","GBIFYN","OBISYN","CountryPointYN","FBSLBYN","CenterLat","CenterLong","FAOAreaM","expert_id","SPECIESID","SPECIESID_2016_Default","SPECIESID_2015","SPECIESID_2013","SPECIESID_2010","IDChange","Reviewed","expert_id","SpecCode","Genus","Species","FBname","FBName_DE","OccurRecs","OccurCells","OccurCells_Exp","OccurCells_2015","OccurCells_2013","Kingdom","Phylum","Class","Order","Family","map_beforeafter","map_seasonal","with_gte_5","with_gte_6","with_gt_66","no_of_cells_3","no_of_cells_5","no_of_cells_0","database_id","picname","entered","total_native_csc_cnt","deepwater","m_mammals","angling","diving","dangerous","m_invertebrates","algae","seabirds","freshwater","highseas","countriesintroduced","invasive","iucn_id","iucn_code","iucn_version","resilience","no_default"],["chr","chr","dbl","int","int","chr","int","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","chr","int","int","int","chr","chr","chr","chr","chr","chr","int","chr","int","int","int","int","chr","int","dbl","dbl","dbl","dbl","dbl","dbl","int","int","dbl","dbl","int","int","int","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","chr","dbl","int","dbl","dbl","dbl","dbl","dbl","dbl","dbl","int","int","int","dbl","dbl","dbl","int","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","int","dbl","dbl","dbl","dbl","dbl","int","dbl","dbl","dbl","dbl","dbl","dbl","int","dbl","chr","chr","chr","chr","chr","int","int","int","int","chr","int","dbl","dbl","dbl","dbl","chr","chr","int","int","dbl","dbl","dbl","dbl","chr","int","dbl","dbl","dbl","dbl","chr","int","dbl","dbl","dbl","dbl","chr","int","dbl","dbl","dbl","dbl","chr","int","dbl","dbl","dbl","dbl","chr","chr","dbl","chr","chr","dbl","chr","chr","chr","chr","chr","int","int","int","chr","chr","chr","chr","chr","chr","chr","int","int","int","int","int","int","int","int","dbl","dbl","int","chr","chr","chr","chr","chr","chr","int","int","int","int","chr","chr","chr","chr","int","int","chr","int","chr","chr","chr","chr","chr","chr","chr","chr","chr","chr","chr","chr","chr","chr","int","chr","int","chr","int","int","int","int","int","int","chr","chr","chr","chr","chr","chr","int","chr","chr","chr","int"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>table<\/th>\n      <th>col_name<\/th>\n      <th>col_type<\/th>\n      <th>desc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script><p>Some column names match across tables, do those represent keys that can be used for linking data across the tables?</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="va">duplicated_colnames</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">am_schema</span><span class="op">$</span><span class="va">col_name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">am_schema</span><span class="op">$</span><span class="va">col_name</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="va">am_keys</span> <span class="op">&lt;-</span> 
  <span class="va">am_schema</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">col_name</span> <span class="op">%in%</span> <span class="va">duplicated_colnames</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">col_name</span><span class="op">)</span>

<span class="co"># sometimes the datatypes are different where the column name are equal</span>

<span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">am_keys</span><span class="op">)</span></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">table</th>
<th align="left">col_name</th>
<th align="left">col_type</th>
<th align="left">desc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">hcaf</td>
<td align="left">CenterLat</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">occ</td>
<td align="left">CenterLat</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hcaf</td>
<td align="left">CenterLong</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">occ</td>
<td align="left">CenterLong</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">nativemaps</td>
<td align="left">CsquareCode</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">CsquareCode</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">occ</td>
<td align="left">CsquareCode</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">DepthMax</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="left">DepthMax</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">DepthMin</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="left">DepthMin</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">occ</td>
<td align="left">expert_id</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">taxa</td>
<td align="left">expert_id</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">FAOAreaM</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">occ</td>
<td align="left">FAOAreaM</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">LME</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="left">LME</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hspen</td>
<td align="left">OccurCells</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">taxa</td>
<td align="left">OccurCells</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hspen</td>
<td align="left">Reviewed</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">taxa</td>
<td align="left">Reviewed</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">SalinityMax</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="left">SalinityMax</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">hcaf</td>
<td align="left">SalinityMin</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="left">SalinityMin</td>
<td align="left">dbl</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">occ</td>
<td align="left">SpecCode</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">taxa</td>
<td align="left">SpecCode</td>
<td align="left">int</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">nativemaps</td>
<td align="left">SpeciesID</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">hspen</td>
<td align="left">SpeciesID</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">occ</td>
<td align="left">SpeciesID</td>
<td align="left">chr</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Are those the relevant keys? Do the data types make sense?</p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">am_schema</span>, path <span class="op">=</span> <span class="st">"~/am-schema.csv"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">am_keys</span>, path <span class="op">=</span> <span class="st">"~/am-keys.csv"</span><span class="op">)</span></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Markus Skyttner.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
